1. Alice and Bob are each creating a one-time pad so they can exchange secret numbers.
First, Alice flips a coin three times, then Bob does the same. As Bob is flipping his
coin for the third time, Eve overhears him exclaim:
    “Wow, we got the same three flips! What are the odds?!”
Later, Eve intercepts a message containing the number 5 from Alice and one
containing the number 3 from Bob. What numbers could Alice and Bob have sent?

Sol:
    Bob and Alice got the same 3 flips of the coin. I'm assuming this is their key.
    They must have used the same key (which is the same length as message), otherwise
    it is impossible to determine their messages as Eve.

    Eve intercepts
    Ca = 101 = 5 -> alice
    Cb = 011 = 3 -> bob

    It follows that
    Ca (XOR) Cb = 101 (XOR) 011 = 110 = Ma (XOR) Mb

    So,
    (Ma, Mb) = (000, 110), (110,000), (101, 011), (010, 100)
             = (0, 6), (1, 7), (3, 5), (4, 2)

2. Suppose you are given a pseudo-random number generator function R that takes
a 128-bit seed s, an integer n, and an integer m, and outputs the nth (inclusive)
through mth (exclusive) pseudo-random bits. Define the key generation algorithm,
the encryption algorithm, and the decryption algorithm you would need to use R
for secure symmetric-key encryption.

Sol:
    Suppose IV is some intialization vector, and sizeof returns the bit length
    of M.

    Symmetric-Key-Generation Algorithm:
    K = KG(s, 0, sizeof(M)) = R(s (XOR) IV, 0, sizeof(M))

    Encryption Algorithm:
    E(M, K) = K (XOR) M = C

    Decryption Algorithm:
    D(C, K) = K (XOR) C = M

3. Your security consulting firm is hired by a secretive government agency that
wants you to steal a mysterious device from a famous number theorist. The job
almost goes awry when his girlfriend shows up just as you are leaving his office,
but you manage to retrieve the device.
    When you get it back to your lab, you decide to play around with it. After a
while, you discover that it does something you didn’t think was possible: it can
factor any prime number in just a few seconds.
    You decide
    (1) that you weren’t paid nearly enough for this job, and
    (2) that there are too many secrets in the world.
    Design a decryption function D(C, KE) that efficiently decrypts any
RSA-encrypted ciphertext C based on the public key KE that was used to encrypt
it. You can represent the function implemented by the device as
    F(n) = p,q,... where n is any number and p,q,... are its prime factors.

Sol:
    Suppose D' is the standard RSA decryption function

    def D(C, KE):
        extract n, e from KE
        F(n) = p, q
        let k = (p - 1)(q - 1)
        let KD = e^-1 mod k
        return D'(C, KD)

4. Alice and Bob want to communicate secretly, but they aren’t sure of the best
way to start. For each attempt, state whether their emails are secure against
    (1) a passive attacker that can observe their emails and
    (2) an active attacker that can observe, replace, or omit their emails.
Explain your answers!
sol:
    Eve - Passive
    Molly - Active

    Eve g^x, g^y, g, p logg(g^x) = x, logg(g^y)
    1. First, Alice and Bob decide to use Diffie-Helman Key Exchange. Bob emails
    Alice g^x and Alice emails Bob g^y . Then they use a secret key g^(xy) to
    encrypt further emails.
        (1) If Eve doesn't know g then it's secure against passive
    attacker since if Eve observed g^x or g^y, she would not be able to compute
    g^(xy), the secret key. But, if Eve knew g and p, she could find x = log_g(g^x)
    and y = log_g(g^y) and then compute the secret key g^(xy).
        (2) If Molly were to observe and replace Alice's emails to Bob with her own
    g^x', then she would effectively become an intermediary between Alice and
    Bob. She would have a secret key for Alice and Bob. No integrity!

    2. Next, Alice and Bob try exchanging public keys over email. Alice sends
    Bob messages encrypted with his public key and Bob sends Alice messages
    encrypted with her public key.
        (1) Eve knows Alice and Bob's public encryption keys, since they were
        sent over email. But, since seh doesn't know their private dec
        (2) Molly could intercept the initial public key exchange. Alice would
        send Molly her key, and Molly would send her key to Alice. Molly would
        then do the same with Bob. Molly would then be an intermediary between
        Alice and Bob, who would be using her public keys to encrypt messages.

    3. Instead of using email to exchange keys, Alice and Bob decide to meet at
    a coffee shop to exchange public encryption and signing keys. However, Alice
    and Bob didn’t notice that Eve was sitting at the next table in the coffee
    shop and managed to take a picture of their public keys while pretending to
    take a selfie. Later they encrypt their emails using the other’s public
    encryption key, and sign the result using their own private signing key.
        (1) Since Eve did not ascertain their signing key, she would not be able
        to get any information from the ciphertext.
        (2) Since Alice is using Bob's signing key, and assuming she knows her
        own, Molly would not be able to pose as either with her own signing key.
        This is because integrity was introduced with Alice and Bob knowing
        eachother's private signing keys and swapping them.

    4. Next, Alice and Bob decide to row a boat out into the Pacific ocean,
    getting under a tarp and generate two keys by rolling a bunch of dice:
    one for encryption and one for signing. Later they sign their emails
    using an HMAC with the signing key and encrypt the body with the encryption
    key.
        (1) Eve wouldn't be able to ascertain any information by observing since
        she can't discover their private encryption keys.
        (2) Molly also wouldn't be able to ascertain any information, since the
        encryption key isnt public and there is a private signing key which
        enforces integrity. Also, since the signing of the email is encrypted
        with HMAC, there is an extra layer of protection.

5. Consider the counter mode of operation. For each of the following scenarios,
state whether the messages encrypted by this algorithm are still secure. If
they are, explain why. If not, explain how an attacker can break the security of
the messages.

    1. The attacker learns the seed used to initialize the PRNG that generates
    the nonce.


    2. The attacker is able to control the value of the nonce.
        It would no longer be secure. If the attacker is able to control the
    value of the nonce, that would make the IV (nonce concat with counter)
    the same each time, and therefore deterministic. That means if the attacker
    knew the ordering of the messages, they would just produce numbers in the
    same order via AES_128 since the nonce concat with counter seeds the PRNG,
    and would produce the same random sequence for each seed.

    3. The attacker is able to control the seed used to initialize the PRNG that
    generates the nonce.
        This would make the algorithm insecure. The nonce is concatenated with
    the
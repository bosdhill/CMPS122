1. Alice and Bob are each creating a one-time pad so they can exchange secret numbers.
First, Alice flips a coin three times, then Bob does the same. As Bob is flipping his
coin for the third time, Eve overhears him exclaim:
    “Wow, we got the same three flips! What are the odds?!”
Later, Eve intercepts a message containing the number 5 from Alice and one
containing the number 3 from Bob. What numbers could Alice and Bob have sent?

Sol:
    Bob and Alice got the same 3 flips of the coin. I'm assuming this is their key.
    They must have used the same key (which is the same length as message), otherwise
    it is impossible to determine their messages as Eve.

    Eve intercepts
    Ca = 101 = 5 -> alice
    Cb = 011 = 3 -> bob

    It follows that
    Ca (XOR) Cb = 101 (XOR) 011 = 110 = Ma (XOR) Mb

    So,
    (Ma, Mb) = (000, 110) or (111, 001) or (110,000) or (001, 111)
             = (0,6) or (8,1) or (6,0) or (1,8)

    Alice and Bob could have sent eachother either 1 and 8, or 6 and 0.

2. Suppose you are given a pseudo-random number generator function R that takes
a 128-bit seed s, an integer n, and an integer m, and outputs the nth (inclusive)
through mth (exclusive) pseudo-random bits. Define the key generation algorithm,
the encryption algorithm, and the decryption algorithm you would need to use R
for secure symmetric-key encryption.

Sol:
    Suppose IV is some intialization vector.

    Symmetric-Key-Generation Algorithm:
    K = KG(N, M) = R(IV, N - IV, M + IV)

    Encryption Algorithm:
    E(M, K) = K (XOR) M = C

    Decryption Algorithm:
    D(C, K) = K (XOR) C = M

3. Your security consulting firm is hired by a secretive government agency that
wants you to steal a mysterious device from a famous number theorist. The job
almost goes awry when his girlfriend shows up just as you are leaving his office,
but you manage to retrieve the device.
    When you get it back to your lab, you decide to play around with it. After a
while, you discover that it does something you didn’t think was possible: it can
factor any prime number in just a few seconds.
    You decide
    (1) that you weren’t paid nearly enough for this job, and
    (2) that there are too many secrets in the world.
    Design a decryption function D(C, KE ) that efficiently decrypts any
RSA-encrypted ciphertext C based on the public key KE that was used to encrypt
it. You can represent the function implemented by the device as
    F(n) = p,q,... where n is any number and p,q,... are its prime factors.

Sol:
    D' is the standard RSA decryption function

    def D(C, KE):
        extract n, e from KE
        F(n) = p, q
        let k = (p - 1)(q - 1)
        let KD = e^-1 mod k
        return D'(C, KD)

4. Alice and Bob want to communicate secretly, but they aren’t sure of the best
way to start. For each attempt, state whether their emails are secure against
    (1) a passive attacker that can observe their emails and
    (2) an active attacker that can observe, replace, or omit their emails.
Explain your answers!
sol:
    Eve - Passive
    Molly - Active

    1. First, Alice and Bob decide to use Diffie-Helman Key Exchange. Bob emails
    Alice g^x and Alice emails Bob g^y . Then they use a secret key g^(xy) to
    encrypt further emails.
        (1) Secure against passive attacker since if Eve observed g^x or g^y,
    she would not be able to compute g^(xy), the secret key.
        (2) If Molly were to observe and replace Alice's emails to Bob with her own
    g^x', then she would effectively become an intermediary between Alice and
    Bob. She would have a secret key for Alice and Bob. (No integrity!)

    2. Next, Alice and Bob try exchanging public keys over email. Alice sends
    Bob messages encrypted with his public key and Bob sends Alice messages
    encrypted with her public key.
        (1) Eve would not be able to observe anything since she doesnt have
    the private decryption keys.
        (2) Molly, acting as an intermediary would be able to receive and
    decrypt Alice's messages with her decryption key, then encrypt and send
    messages to Bob. This would allow her to act as Alice towards Bob and vice
    versa.

    3. Instead of using email to exchange keys, Alice and Bob decide to meet at
    a coffee shop to exchange public encryption and signing keys. However, Alice
    and Bob didn’t notice that Eve was sitting at the next table in the coffee
    shop and managed to take a picture of their public keys while pretending to
    take a selfie. Later they encrypt their emails using the other’s public
    encryption key, and sign the result using their own private signing key.
        (1)
        (2)

    4. Next, Alice and Bob decide to row a boat out into the Pacific ocean,
    getting under a tarp and generate two keys by rolling a bunch of dice:
    one for encryption and one for signing. Later they sign their emails
    using an HMAC with the signing key and encrypt the body with the encryption
    key.
        (1)
        (2)

5. Consider the counter mode of operation. For each of the following scenarios,
state whether the messages encrypted by this algorithm are still secure. If
they are, explain why. If not, explain how an attacker can break the security of
the messages.
    1. The attacker learns the seed used to initialize the PRNG that generates
    the nonce.
    2. The attacker is able to control the value of the nonce.
    3. The attacker is able to control the seed used to initialize the PRNG that
    generates the nonce.